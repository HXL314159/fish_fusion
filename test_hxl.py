import matplotlib.pyplot as plt
import numpy as np

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei', 'Microsoft YaHei']
plt.rcParams['axes.unicode_minus'] = False

# current_train_acc数据
current_train_acc = [
    0.5064256385644963, 0.6227803551431771, 0.7988055244494214, 0.8718071775182638,
    0.801365114914947, 0.8959633125366608, 0.9323308270676691, 0.7299632058870581,
    0.9544606196341918, 0.6532288167226578, 0.6259265184237188, 0.8591691995947315,
    0.9489681650935851, 0.9388897776355783, 0.7623846851170479, 0.8072308430651096,
    0.8629552604916547, 0.7727296965818803, 0.7268703674078814, 0.9625659894416894,
    0.9630992374553404, 0.7314563003252813, 0.9575534581133686, 0.8857249506745587,
    0.588865781474964, 0.9113208553298139, 0.9243321068629019, 0.9745640697488401,
    0.913720471391244, 0.9026822375086653, 0.9417159921079294, 0.5883325334613129,
    0.9416093425051991, 0.9812296699194796, 0.954034021223271, 0.9542473204287314,
    0.864021756518957, 0.8726603743401056, 0.7966725323948168, 0.9010291686663467,
    0.7761958086706127, 0.9450754545939316, 0.9585133045379406, 0.9617661174212127,
    0.9405428464778969, 0.9336106223004319, 0.7068735668959634, 0.8878579427291633,
    0.6302991521356583, 0.9477950194635525, 0.6448034981069696, 0.9780835066389377,
    0.7584386498160295, 0.9697115128246148, 0.9059350503919373, 0.9258252013011251,
    0.8370394070282088, 0.9015090918786327, 0.645976643737002, 0.9458220018130432,
    0.9696581880232497, 0.9479549938676478, 0.931744254252653, 0.9838959099877354,
    0.9419292913133899, 0.9604863221884499, 0.8006718924972005, 0.9938143230416466,
    0.3282674772036474, 0.7157254839225724, 0.955420466058764, 0.9750439929611262,
    0.7681970884658454, 0.5611368847651043, 0.964698981496294, 0.9822428411454167,
    0.9933877246307258, 0.9941875966512025, 0.5432197515064257, 0.7079933877246307,
    0.7893670346077961, 0.8351197141790647, 0.7361488828454114, 0.8678611422172452,
    0.884925078654082, 0.6197408414653656, 0.906734922412414, 0.9487548658881245,
    0.9667786487495335, 0.727616914626993, 0.9691782648109636, 0.9231589612328694,
    0.9744574201461099, 0.8897776355783075, 0.5989974937343359, 0.6753052844878152,
    0.9540873460246361, 0.9200127979523276, 0.949874686716792, 0.9864555004532608,
    0.9634725110648963, 0.9595264757638777, 0.8923905508451981, 0.5590038927104997,
    0.9212392683837253, 0.9906148349597398, 0.8627952860875593, 0.9819228923372261,
    0.9935476990348211, 0.9933343998293607, 0.995840665493521, 0.9974404095344744,
    0.9976003839385699, 0.9976003839385699, 0.9975470591372048, 0.9974937343358395,
    0.9974404095344744, 0.9974404095344744, 0.7455873726870368, 0.9762704633925239,
    0.9212925931850904, 0.968005119180931, 0.9355836399509412, 0.9345171439236389,
    0.7310297019143603, 0.9499280115181571, 0.9762704633925239, 0.9900815869460886,
    0.9676318455713753, 0.9926411774116142, 0.9761638137897937, 0.9877352956860236,
    0.9770703354130006, 0.9839492347891005, 0.8593291739988268, 0.975897189782968,
    0.9324374766703994, 0.7975790540180238, 0.959579800565243, 0.9840558843918307,
    0.6181410974244121, 0.44280915053591424, 0.9628326134485149, 0.9947208446648537,
    0.9982936063563164, 0.9986668799658721, 0.9987202047672372, 0.9989335039726978,
    0.9987735295686023, 0.9987735295686023, 0.9987202047672372, 0.9989335039726978,
    0.9988268543699674, 0.9986668799658721, 0.9987202047672372, 0.998613555164507,
    0.998613555164507, 0.9986668799658721, 0.998613555164507, 0.998613555164507,
    0.998613555164507, 0.9987735295686023, 0.9987202047672372, 0.9987202047672372,
    0.9987735295686023, 0.8448248280275156, 0.9813363195222098, 0.9831493627686236,
    0.9748840185570309, 0.9802698234949074, 0.7088465845464725, 0.9700847864341705,
    0.9944008958566629, 0.9547805684423826, 0.9966938623153628, 0.9920012797952328,
    0.9364901615741481, 0.925291953287474, 0.5963845784674452, 0.9282781421639205,
    0.9833093371727191, 0.9750973177624913, 0.9932277502266305, 0.9715778808723937,
    0.7899536074228124, 0.9742974457420146, 0.973124300111982, 0.9756838905775076,
    0.9892283901242468, 0.9819228923372261, 0.9601663733802591, 0.9808563963099237,
    0.9923212286034234, 0.8247747027142324, 0.8779928544766171, 0.9360635631632273,
    0.9571801845038127, 0.9706180344478217, 0.9713645816669333, 0.9827227643577028,
    0.944755505785741
]

# 创建epoch数组
epochs = np.arange(len(current_train_acc))

# 创建图形
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

# 第一个子图：完整的训练准确率曲线
ax1.plot(epochs, current_train_acc, 'b-', linewidth=2, label='训练准确率')
ax1.set_xlabel('Epoch')
ax1.set_ylabel('准确率')
ax1.set_title('训练准确率随Epoch变化曲线')
ax1.grid(True, alpha=0.3)
ax1.legend()
ax1.set_ylim(0, 1.1)

# 第二个子图：放大查看波动细节（前100个epoch）
ax2.plot(epochs[:100], current_train_acc[:100], 'r-', linewidth=1.5, label='训练准确率（前100个epoch）')
ax2.set_xlabel('Epoch')
ax2.set_ylabel('准确率')
ax2.set_title('训练准确率细节（前100个Epoch）')
ax2.grid(True, alpha=0.3)
ax2.legend()
ax2.set_ylim(0.3, 1.0)

plt.tight_layout()
plt.show()

# 创建统计信息图表
fig, ax = plt.subplots(1, 2, figsize=(12, 5))

# 统计信息
stats_data = {
    '最终准确率': current_train_acc[-1],
    '最高准确率': max(current_train_acc),
    '平均准确率': np.mean(current_train_acc),
    '最低准确率': min(current_train_acc)
}

# 柱状图显示统计信息
categories = list(stats_data.keys())
values = list(stats_data.values())
colors = ['#ff9999', '#66b3ff', '#99ff99', '#ffcc99']

ax[0].bar(categories, values, color=colors, alpha=0.7)
ax[0].set_ylabel('准确率')
ax[0].set_title('训练准确率统计信息')
ax[0].set_ylim(0, 1.1)

# 在柱子上添加数值标签
for i, v in enumerate(values):
    ax[0].text(i, v + 0.02, f'{v:.4f}', ha='center', va='bottom')

# 准确率分布直方图
ax[1].hist(current_train_acc, bins=20, alpha=0.7, color='skyblue', edgecolor='black')
ax[1].set_xlabel('准确率')
ax[1].set_ylabel('频次')
ax[1].set_title('训练准确率分布直方图')
ax[1].axvline(np.mean(current_train_acc), color='red', linestyle='--',
             label=f'平均值: {np.mean(current_train_acc):.4f}')
ax[1].legend()

plt.tight_layout()
plt.show()

# 打印统计信息
print("训练准确率统计信息：")
print(f"数据点数: {len(current_train_acc)}")
print(f"最高准确率: {max(current_train_acc):.4f} (第{np.argmax(current_train_acc)}个epoch)")
print(f"最终准确率: {current_train_acc[-1]:.4f}")
print(f"平均准确率: {np.mean(current_train_acc):.4f}")
print(f"准确率标准差: {np.std(current_train_acc):.4f}")
print(f"最低准确率: {min(current_train_acc):.4f} (第{np.argmin(current_train_acc)}个epoch)")

# 计算达到不同准确率水平所需的epoch数
accuracy_levels = [0.7, 0.8, 0.9, 0.95, 0.98]
print("\n达到不同准确率水平所需的epoch数：")
for level in accuracy_levels:
    for i, acc in enumerate(current_train_acc):
        if acc >= level:
            print(f"{level:.0%} 准确率: 第{i}个epoch")
            break
    else:
        print(f"{level:.0%} 准确率: 未达到")




